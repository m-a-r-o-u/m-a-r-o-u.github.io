<!doctype html>
<html lang="en" id="top">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mares Barekzai, PhD</title>
    <style>
      :root {
        --bg: #020202;
        --text: #f2f2f2;
        --muted: #7a7a7a;
        --line: #171717;
      }

      * { box-sizing: border-box; }

      html, body {
        margin: 0;
        min-height: 100%;
        background: var(--bg);
      }

      html { scrollbar-gutter: stable; }

      body {
        color: var(--text);
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      }

      .hero-wrap {
        display: grid;
        place-items: center;
        min-height: 66vh;
        padding: 36px 28px 8px;
        transition: min-height 180ms ease, padding-bottom 180ms ease;
      }

      body.has-panel .hero-wrap {
        min-height: 52vh;
        padding-bottom: 4px;
      }

      .hero { text-align: center; }

      .avatar-link {
        display: inline-block;
        border-radius: 999px;
      }

      .avatar {
        width: 168px;
        aspect-ratio: 1;
        border-radius: 999px;
        margin: 0 auto 18px;
        border: 1px solid #1f1f1f;
        background:
          radial-gradient(circle at 34% 34%, #71e6ff 0 11%, transparent 12%),
          radial-gradient(circle at 65% 60%, #f06ac5 0 12%, transparent 13%),
          linear-gradient(120deg, #113447 0%, #182730 52%, #24192f 100%);
      }

      .avatar-link:hover .avatar,
      .avatar-link:focus-visible .avatar {
        border-color: #2a2a2a;
      }

      h1 {
        margin: 0;
        font-size: clamp(1.55rem, 4.2vw, 2.45rem);
        color: #f6f6f6;
        letter-spacing: 0.14px;
      }

      .section-nav {
        margin-top: 12px;
        display: flex;
        justify-content: center;
        gap: 18px;
        flex-wrap: wrap;
      }

      .section-nav a {
        color: var(--muted);
        text-decoration: none;
        border-bottom: 1px dashed transparent;
      }

      .section-nav a:hover,
      .section-nav a:focus-visible,
      .section-nav a.active {
        color: #c9c9c9;
        border-bottom-color: currentColor;
        outline: none;
      }

      .social {
        margin-top: 16px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 18px;
      }

      .social a {
        width: 32px;
        height: 32px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        border: 1px solid transparent;
        text-decoration: none;
        transition: transform 120ms ease, border-color 120ms ease;
      }

      .social a:hover,
      .social a:focus-visible {
        transform: translateY(-1px);
        border-color: currentColor;
        outline: none;
      }

      .social svg {
        width: 22px;
        height: 22px;
      }

      .github { color: #9a57ff; }
      .linkedin { color: #0a8cff; }
      .scholar { color: #efc24b; }

      .content {
        width: min(920px, 92vw);
        margin: 0 auto 42px;
      }

      .panel {
        border-top: 1px solid var(--line);
        padding-top: 16px;
        margin-top: 14px;
      }

      .panel[hidden] { display: none; }

      .panel h1,
      .panel h2,
      .panel h3 {
        margin: 0 0 10px;
        color: #71e6ff;
      }

      .panel h1 { font-size: 1.05rem; }
      .panel h2 { font-size: 1rem; }
      .panel h3 { font-size: 0.95rem; }

      .panel p,
      .panel li {
        line-height: 1.6;
        color: #d7d7d7;
      }

      .panel ul {
        margin: 0;
        padding-left: 1.2rem;
      }

      .panel li { margin-bottom: 8px; }

      .panel a {
        color: #c8e8ff;
        text-decoration: none;
        border-bottom: 1px dashed transparent;
      }

      .panel a:hover,
      .panel a:focus-visible {
        border-bottom-color: currentColor;
        outline: none;
      }

      .panel .loading,
      .panel .error {
        color: var(--muted);
      }

      .visually-hidden {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
    </style>
  </head>
  <body>
    <div class="hero-wrap">
      <main class="hero">
        <a class="avatar-link" href="#" id="home-link" aria-label="Back to landing top">
          <div class="avatar" aria-hidden="true"></div>
        </a>
        <h1>Mares Barekzai, PhD</h1>

        <nav class="section-nav" aria-label="Section navigation">
          <a href="#cv" data-target="cv">CV</a>
          <a href="#projects" data-target="projects">Projects</a>
          <a href="#contact" data-target="contact">Contact</a>
        </nav>

        <nav class="social" aria-label="Social links">
          <a class="github" href="https://github.com/m-a-r-o-u" target="_blank" rel="noreferrer noopener" aria-label="GitHub">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M9 19c-4.5 1.4-4.5-2.5-6-3m12 6v-3.6a3.2 3.2 0 0 0-.9-2.5c3-.3 6.1-1.5 6.1-6.8a5.2 5.2 0 0 0-1.4-3.6 4.8 4.8 0 0 0-.1-3.5s-1.2-.4-3.8 1.4a13.2 13.2 0 0 0-7 0C5.3 1.6 4.1 2 4.1 2a4.8 4.8 0 0 0-.1 3.5 5.2 5.2 0 0 0-1.4 3.6c0 5.3 3.1 6.5 6.1 6.8a3.2 3.2 0 0 0-.9 2.5V22"/>
            </svg>
            <span class="visually-hidden">GitHub</span>
          </a>

          <a class="linkedin" href="https://www.linkedin.com/in/m-a-r-e-s-b-a-r-e-k-z-a-i/" target="_blank" rel="noreferrer noopener" aria-label="LinkedIn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <rect x="2.5" y="2.5" width="19" height="19" rx="2.2"/>
              <circle cx="8" cy="8" r="1.2" fill="currentColor" stroke="none"/>
              <path d="M7 11.2v6.2M11.2 17.4v-3.7c0-1.2.9-2.2 2.1-2.2s2.1 1 2.1 2.2v3.7M11.2 12.3v-.9"/>
            </svg>
            <span class="visually-hidden">LinkedIn</span>
          </a>

          <a class="scholar" href="https://scholar.google.com/citations?user=WXlo9H0AAAAJ&hl=en" target="_blank" rel="noreferrer noopener" aria-label="Google Scholar">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M12 3 2.8 8 12 13 21.2 8 12 3Z"/>
              <path d="M6.5 10.2v4.2c0 1.7 2.4 3.1 5.5 3.1s5.5-1.4 5.5-3.1v-4.2"/>
              <path d="M21.2 8v5.3"/>
            </svg>
            <span class="visually-hidden">Google Scholar</span>
          </a>
        </nav>
      </main>
    </div>

    <div class="content">
      <section class="panel" id="cv" hidden></section>
      <section class="panel" id="projects" hidden></section>
      <section class="panel" id="contact" hidden></section>
    </div>

    <script>
      (function () {
        const navLinks = Array.from(document.querySelectorAll('.section-nav a[data-target]'));
        const panels = Array.from(document.querySelectorAll('.panel'));
        const homeLink = document.getElementById('home-link');
        const cache = new Map();

        const sectionFiles = {
          cv: 'content/cv.md',
          contact: 'content/contact.md',
          projects: 'content/projects/index.md'
        };

        const projectFiles = {
          'gpu-workload-optimization-playbook': 'content/projects/gpu-workload-optimization-playbook.md',
          'research-cluster-onboarding-kit': 'content/projects/research-cluster-onboarding-kit.md',
          'reproducible-hpc-pipelines': 'content/projects/reproducible-hpc-pipelines.md'
        };

        function escapeHtml(text) {
          return text
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#039;');
        }

        function parseInline(text) {
          return escapeHtml(text)
            .replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2">$1</a>')
            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
            .replace(/\*(.*?)\*/g, '<em>$1</em>')
            .replace(/`(.*?)`/g, '<code>$1</code>');
        }

        function markdownToHtml(markdown) {
          const lines = markdown.replace(/\r/g, '').split('\n');
          const html = [];
          const paragraph = [];
          let inList = false;

          function flushParagraph() {
            if (!paragraph.length) return;
            html.push(`<p>${parseInline(paragraph.join(' '))}</p>`);
            paragraph.length = 0;
          }

          function closeList() {
            if (!inList) return;
            html.push('</ul>');
            inList = false;
          }

          lines.forEach((rawLine) => {
            const line = rawLine.trim();

            if (!line) {
              flushParagraph();
              closeList();
              return;
            }

            const headingMatch = line.match(/^(#{1,3})\s+(.+)$/);
            if (headingMatch) {
              flushParagraph();
              closeList();
              const level = headingMatch[1].length;
              html.push(`<h${level}>${parseInline(headingMatch[2])}</h${level}>`);
              return;
            }

            const listMatch = line.match(/^[-*]\s+(.+)$/);
            if (listMatch) {
              flushParagraph();
              if (!inList) {
                html.push('<ul>');
                inList = true;
              }
              html.push(`<li>${parseInline(listMatch[1])}</li>`);
              return;
            }

            paragraph.push(line);
          });

          flushParagraph();
          closeList();
          return html.join('');
        }

        async function readMarkdown(path) {
          if (cache.has(path)) return cache.get(path);
          const response = await fetch(path, { cache: 'no-cache' });
          if (!response.ok) throw new Error(`Unable to load ${path}`);
          const text = await response.text();
          cache.set(path, text);
          return text;
        }

        function hideAllPanels() {
          panels.forEach((panel) => {
            panel.hidden = true;
            panel.innerHTML = '';
          });
          navLinks.forEach((link) => link.classList.remove('active'));
          document.body.classList.remove('has-panel');
        }

        function setActiveLink(section) {
          navLinks.forEach((link) => {
            link.classList.toggle('active', link.dataset.target === section);
          });
        }

        async function renderSection(section, path) {
          const panel = document.getElementById(section);
          if (!panel) return;
          panel.innerHTML = '<p class="loading">Loadingâ€¦</p>';

          try {
            const markdown = await readMarkdown(path);
            panel.innerHTML = markdownToHtml(markdown);
          } catch (error) {
            panel.innerHTML = '<p class="error">Could not load section content.</p>';
          }
        }

        async function renderRoute() {
          const hash = window.location.hash.replace(/^#/, '');
          const [section, projectSlug] = hash.split('/');

          if (!sectionFiles[section]) {
            hideAllPanels();
            return;
          }

          hideAllPanels();
          document.body.classList.add('has-panel');
          setActiveLink(section);
          const targetPanel = document.getElementById(section);
          targetPanel.hidden = false;

          if (section === 'projects' && projectSlug) {
            const projectPath = projectFiles[projectSlug];
            if (projectPath) {
              await renderSection(section, projectPath);
            } else {
              targetPanel.innerHTML = '<p class="error">Project not found. <a href="#projects">Return to projects</a>.</p>';
            }
          } else {
            await renderSection(section, sectionFiles[section]);
          }

          // Keep the nav links under the cursor while switching sections.
          // We intentionally avoid auto-scrolling here.
        }

        function navigateToHash(hashValue) {
          const nextHash = hashValue.startsWith('#') ? hashValue : `#${hashValue}`;
          history.pushState({ hash: nextHash }, '', `${window.location.pathname}${window.location.search}${nextHash}`);
          renderRoute();
        }

        navLinks.forEach((link) => {
          link.addEventListener('click', (event) => {
            event.preventDefault();
            const target = link.dataset.target;
            if (!target) return;
            navigateToHash(target);
          });
        });

        document.addEventListener('click', (event) => {
          const anchor = event.target.closest('a[href^="#"]');
          if (!anchor) return;
          const href = anchor.getAttribute('href') || '';
          const route = href.replace(/^#/, '');
          const routeSection = route.split('/')[0];
          if (!sectionFiles[routeSection]) return;
          event.preventDefault();
          navigateToHash(href);
        });

        window.addEventListener('hashchange', renderRoute);
        window.addEventListener('popstate', renderRoute);
        window.addEventListener('DOMContentLoaded', renderRoute);

        if (homeLink) {
          homeLink.addEventListener('click', (event) => {
            event.preventDefault();
            history.pushState('', document.title, window.location.pathname + window.location.search);
            hideAllPanels();
            window.scrollTo({ top: 0, behavior: 'smooth' });
          });
        }
      })();
    </script>
  </body>
</html>
